<!DOCTYPE html>
<html>
	<head>
	<meta charset="UTF-8"/>
    <meta https-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no, initial-scale=1">
    <meta name = "format-detection" content = "telephone=no"><!--防止iOS网页中的数字被识别为电话号码-->
    <meta name="screen-orientation" content="portrait"><!-- uc强制竖屏 -->
    <meta name="x5-orientation" content="portrait"><!-- QQ强制竖屏 -->
	<title>小车</title>
	
	<script src="https://i2.Yongche.name/s/js/201712/flexible.js?1478153218"></script>
	<style type="text/css">
		*{margin:0;padding:0;box-sizing:border-box}html,body{width:10.0rem;height:100%;position:relative}ul,li{list-style:none}input{outline:0;border:0;-webkit-appearance:none}.wrapper{width:10.0rem;height:100%}.mask{position:absolute;top:0;right:0;width:10.0rem;height:100%;line-height:.67rem;font-size:30px;background:rgba(0,0,0,0.4);display:none}.mask .container{margin:1.70rem auto 0;width:7.76rem;height:12.0rem;background:url(http://i1.yongche.name/media/g2/M02/1B/3C/rBEBJVpsgt6IVu3qAAA4m4S8h3AAAK3pwDtm3AAADiz299.jpg);border:.08rem solid #fcd315;border-radius:.2rem;position:relative;color:#eca205;font-size:.346667rem}.mask .container .mask-title{width:3.933333rem;height:1.133333rem;font-size:.64rem;line-height:1.0rem;text-align:center;border-radius:.24rem;margin:-0.533333rem auto 0;background:#fdd65f;border:.08rem solid #fcd315;border-radius:.2rem;color:#fff}.mask .close_btn{margin:.2rem auto;width:.907rem;height:.907rem;background:url(http://i2.yongche.name/media/g2/M02/1B/3C/rBEBJVpsgt6IdibaAAAK4o2vF1QAAK3pwDnPOsAAAr6941.png) no-repeat;background-size:100%}#rule .rule-contain{line-height:.506667rem;padding:0 .506667rem 0 .8rem}#rule .rule-contain ul{list-style:decimal;margin-top:.15rem}#rule .rule-contain .rule-item{margin-bottom:.266667rem}#prize .prize-contain .prizewrapper{height:11.0rem;overflow:scroll}#prize .prize-contain .prizeitem{margin:.8rem auto;width:5.906667rem;height:1.946667rem;padding:.2rem 0 0 2.8rem;font-size:.28rem}#prize .prize-contain .prize95{background:url(http://i1.yongche.name/media/g2/M03/1B/3C/rBEBP1pshD-IYLyRAAA-lB9qS6UAAK3pQMbY10AAD6s578.png) no-repeat;background-size:100% 100%}#prize .prize-contain .prize90{background:url(http://i2.yongche.name/media/g2/M03/1B/3C/rBEBP1pshD-IbSsxAAA6QVVasEQAAK3pQMbKQQAADpZ639.png) no-repeat;background-size:100% 100%}#prize .prize-contain .prize85{background:url(http://i2.yongche.name/media/g2/M02/1B/3C/rBEBJVpshD-IJ_SqAAA_aAMF4nEAAK3pwGGAZ4AAD-A439.png) no-repeat;background-size:100% 100%}#prize .prize-contain .prizeitem-owner{display:inline-block;max-width:1.5rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;vertical-align:top}.leadPage-mask{background:url(http://i1.yongche.name/media/g2/M02/1B/3C/rBEBJVpsgt6IRTWKAABMifFwiTgAAK3pwDtJqEAAEyh459.png);background-size:100%}#close_leadPage{position:absolute;right:.8rem;top:.7rem}#over .over-contain .top-contain{margin-bottom:.69rem;height:5.6rem;padding:.1px}#over .over-contain .winer{display:none}#over .over-contain .loser{font-size:.6rem;text-align:center;line-height:1.3rem;padding:1.3rem 0 0 0;display:none}#over .over-contain .gongxi{margin:.33333rem auto 0;width:6.693333rem;height:2.36rem;background:url(http://i1.yongche.name/media/g2/M02/1B/3C/rBEBP1psgt2IRvRVAACt4ep_JkcAAK3pwDt4esAAK35479.jpg);background-size:100%}#over .over-contain .discount{margin:.53rem auto 0;width:6.666667rem;height:2.306667rem;padding:.5rem 0 0 3.2rem}#over .over-contain .discount95{background:url(http://i1.yongche.name/media/g2/M03/1B/3C/rBEBP1pshD-IYLyRAAA-lB9qS6UAAK3pQMbY10AAD6s578.png) no-repeat;background-size:100% 100%}#over .over-contain .discount90{background:url(http://i2.yongche.name/media/g2/M03/1B/3C/rBEBP1pshD-IbSsxAAA6QVVasEQAAK3pQMbKQQAADpZ639.png) no-repeat;background-size:100% 100%}#over .over-contain .discount85{background:url(http://i2.yongche.name/media/g2/M02/1B/3C/rBEBJVpshD-IJ_SqAAA_aAMF4nEAAK3pwGGAZ4AAD-A439.png) no-repeat;background-size:100% 100%}#over .over-contain .line{font-size:.453333rem;color:#a8a381;text-align:center}#over .over-contain #totalscore{font-size:.8rem}#over .over-contain .playagin{margin:.5rem auto;width:4.93rem;height:.986667rem;border-radius:.49rem;text-align:center;line-height:.986rem;font-size:.45rem;color:#f5f5f5;background:#ff5b5b}#over .over-contain .noagin{background:#ccc}#over .over-contain .sharetofriend{margin:0 auto;width:4.93rem;height:.986rem;line-height:.986rem;text-align:center;font-size:.45rem;color:#ff5b5b;border-bottom:1px solid #ff5b5b}#loginMask .login-contain{padding:.8rem;text-align:left;background:#fff;border:0;height:auto;margin-top:3.0rem}.login-contain .login-title{font-size:.5rem;line-height:1.3rem}.login-contain .login-input{margin-bottom:.3rem;display:inline-block;width:6.2rem;height:1.067rem;border:1px solid #ccc;border-radius:.5rem;font-size:.373333rem;padding-left:.33333rem}.login-contain .login-input-short{width:3.3rem;display:inline-block;vertical-align:top;margin-right:.1rem}.login-contain .login-code{width:2.5rem;height:1.067rem;font-size:.373333rem;display:inline-block}.login-contain .login-getmsgcode{color:#fff;background:#e92c2a;border-radius:.5rem}.login-contain .login-captchacode{background:#ccc}.login-contain .login-captchacode-wrapper{display:none}.login-contain .login-btn{width:6.2rem;height:1.067rem;color:#fff;background:#e92c2a;border-radius:.5rem;font-size:.55rem;text-align:center;line-height:1.067rem}
	</style>
		
	</head>
	<body>
		<div class="wrapper"> 
			<div id="game"></div>
		
			<div id="rule" class="mask rule-mask">
				<div class="container rule-contain">
					<div class="mask-title">活动规则</div>
					<ul>
						<li class="rule-item">每位用户第一次进入游戏时获得一次免费游戏机会； </li>
						<li class="rule-item">用户每打一次车，会获得一次游戏机会，邀请好友参加游戏后，双方各获得一次游戏机会，每个用户每天最多获得4次通过邀请得到的游戏机会，且每位用户只能在一天内被邀请一次；</li>
						<li class="rule-item">当游戏开始后，在60秒内，左右滑动汽车，每得到一个金币加100分，撞到障碍物游戏结束； </li>
						<li class="rule-item">游戏结束后，可根据所获得金币数所对应的积分获取奖励，所获奖品请在“我的奖品”页面查看； </li>
						<li class="rule-item">奖品对应积分为：3000分可获得——9.5折优惠券一张，5000分可获得——9折优惠券一张，7000分以上可获得——8.5折优惠券一张，所获优惠券可用于用车费的部分抵扣，优惠券使用规则请参见易到App个人中心优惠券页面。</li>
					</ul>
				</div>
				<div id="close_rule" class="close_btn"></div>
			</div>
			<div id="prize" class="mask prize-mask">
				<div class="container prize-contain">
					<div class="mask-title">我的奖品</div>
					<div class="prizewrapper">
						<ul>
							<li class="prizeitem prize95">
								<div >仅限<span class="prizeitem-owner">12345</span>使用</div>
								<div>有效期至<span class="prizeitem-deadtime">2018.2.26</span></div>
							</li>
							<li class="prizeitem prize90">
								<div >仅限<span class="prizeitem-owner">1243543</span>使用</div>
								<div>有效期至<span class="prizeitem-deadtime">2018.2.26</span></div>
							</li>
							<li class="prizeitem prize85">
								<div >仅限<span class="prizeitem-owner">345656575687979879</span>使用</div>
								<div>有效期至<span class="prizeitem-deadtime">2018.2.26</span></div>
							</li>
							<li class="prizeitem prize95">lallal </li>
							<li class="prizeitem prize90">lallal </li>
							<li class="prizeitem prize85">lallal </li>
						</ul>
					</div>
					
				</div>
				<div id="close_prize" class="close_btn"></div>
			</div>
			<div id="over" class="mask over-mask">
				<div class="container over-contain">
					<div class="mask-title">游戏结束</div>
					<div class="winer top-contain"><!--恭喜获得-->
						<div class="gongxi"></div>
						<div class="discount discount90">
							<div >仅限<span id="over-owner">****</span>使用</div>
							<div>有效期至<span id="over-deadtime">2018.2.26</span></div>
						</div>
					</div>
					<div class="loser top-contain"><!--真遗憾-->
						<div class="loser1">真遗憾，</div>
						<div class="loser2">离奖励就差一点了</div>
					</div>
					<div class="line totalscore">累计获得<span id="totalscore">88</span>分</div>
					<div class="line defeat">击败<span id="defeat">99</span>%用户</div>
					<div id="playagin" class="playagin ">再玩一次（剩余<span id="gameNum">4</span>次）</div>
					<div id="sharetofriend" class="sharetofriend">邀好友来玩再得机会</div>
				</div>
			</div>
			<div id="leadPage" class="mask leadPage-mask">
				<div id="close_leadPage" class="close_btn"></div>
			</div>
			<div id="loginMask" class="mask login-mask">
				<div class="container login-contain">
		            <div class="login-title">手机号登录</div>
		            <input id="login-tel" type="tel" class="login-input" placeholder="请输入手机号" maxlength="11">
		            
		            <div class="login-captchacode-wrapper"> <!--图形验证码-->
		                <input id="login-captchacode" class="login-input login-input-short" type="text" placeholder="请输入验证码" maxlength="4">
		                <span class="login-code login-captchacode"><img  id="login-getcaptchacode" width="100%" height="100%" src="https://market.yongche.com/activity/Webuser/getCaptcha"></span>
		            </div>
		            <div>  <!--短信验证码-->
		                <input id="login-msgcode" class="login-input login-input-short" type="tel" placeholder="请输入验证码" maxlength="6">
		                <input id="login-getmsgcode" type="button" class="login-code login-getmsgcode" value="获取验证码">
		            </div>
		            <div id="login-btn" class="login-btn">登&nbsp;&nbsp;&nbsp;录</div>
		        </div>
	        </div>
		</div>
	<script>
		//
	</script>
	<script src="gamelib/phaser.min.js"></script>
	<script src="js/jquery-3.0.0.min.js"></script>
	<script src="//res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
	<!--//DOM及接口请求-->
	<script>
		var gameNum="--";var shareToken="";var gameToken="";var isLogin=false;var httpHead="https://testing2-market.Yongche.org";$("#close_rule").click(function(){$("#rule").fadeOut(300)});$("#close_prize").click(function(){$("#prize").fadeOut(300)});$("#close_leadPage").click(function(){$("#leadPage").fadeOut(300)});$("#playagin").click(function(){if(gameNum<=0){return}$("#over").hide();gameNum--;game.state.start("play")});$("#sharetofriend").click(shareFn);function shareFn(){alert("shareFn分享");if(inApp){alert("端内分享")}else{alert("请点右上角分享")}}var wShare={};wShare.shareImg="http://i2.yongche.Name/media/g2/M03/1A/35/rBEBJVo84_iIZPtgAAAydsM-krwAAKcBQLESpgAADKO907.jpg";wShare.shareTitle="金币大作战";wShare.shareContent="金币大作战";wShare.shareUrl=window.location.href;window.onresize=function(){};var telInput=$("#login-tel"),msgInput=$("#login-msgcode"),captchaInput=$("#login-captchacode"),getmsgcodeBtn=$("#login-getmsgcode"),getcaptchaBtn=$("#login-getcaptchacode"),loginBtn=$("#login-btn"),helphimBtn=$("#helphim"),need_imgcode=0,cellphone,captcha,msgcode;var isYidao=document.cookie.indexOf("_app_token_v3");var inApp=isYidao===-1?false:true;function initData(){$.ajax({type:"get",url:httpHead+"/Miscellaneous/Activityusergame/getCommon",dataType:"jsonp",success:function(a){if(a.code==200){alert("已登录");game.state.start("created");isLogin=true;gameNum=a.result.gameNum;shareToken=a.result.shareToken}else{if(a.code==403){console.log("未登录");isLogin=false}else{if(a.code==504){console.log("不在活动期间")}else{if(a.code==500){console.log("用户信息为空")}else{if(a.code==507){console.log("访问频率过快")}}}}}},error:function(a){alert(a.msg)}})}function startGame(){$.ajax({type:"get",url:httpHead+"/Miscellaneous/Activityusergame/startGame",dataType:"jsonp",success:function(a){if(a.code==200){alert("startGame");gameToken=a.result.gameToken}else{if(a.code==403){console.log("未登录")}else{if(a.code==504){console.log("不在活动期间")}else{if(a.code==500){console.log("用户信息为空")}else{if(a.code==507){console.log("访问频率过快")}}}}}},error:function(a){alert(a.msg)}})}function endGame(b,a){$.ajax({type:"get",url:httpHead+"/Miscellaneous/Activityusergame/endGame?gameToken="+b+"&goldNum="+a,dataType:"jsonp",success:function(c){if(c.code==200){alert("endGame")}else{if(c.code==400){console.log("参数不正确")}else{if(c.code==401){console.log("请从正常渠道参与游戏")}else{if(c.code==504){console.log("不在活动期间")}else{if(c.code==500){console.log("用户信息为空")}else{if(c.code==503){console.log("服务器正在偷懒，请稍后重试")}}}}}}},error:function(c){alert(c.msg)}})}var shareToken=GetQueryString("shareToken");helphimBtn.click(helphimFn);function helphimFn(){$.ajax({url:httpHead+"/Miscellaneous/Activityusergame/helpUser?shareToken="+shareToken,type:"get",dataType:"jsonp",success:function(a){console.log(a);alert("您已为好友增加抽奖次数，赶快来参与活动吧！")},error:function(a){alert(a.msg)}})}loginBtn.click(function(){cellphone=telInput.val();msgcode=msgInput.val();captcha=captchaInput.val();if(!checkMobile(cellphone)){alert("请输入正确手机号");return false}if(need_imgcode==1&&!captcha){alert("请输入图形验证码");return false}if(!msgcode){alert("请输入短信验证码");return false}$.ajax({url:httpHead+"/activity/Webuser/Login?cellphone="+cellphone+"&code="+msgcode+"&captcha="+captcha,type:"get",dataType:"jsonp",success:function(a){console.log(a);if(a.code==200){alert("登录成功");initData();if(shareToken){helphimFn()}else{alert("邀请人未参与该活动")}}else{alert(a.code,a.msg)}},error:function(a){alert(data.msg)}})});getmsgcodeBtn.click(function(){cellphone=telInput.val();captcha=captchaInput.val();var a=checkMobile(cellphone);if(!a){alert("请输入正确的手机号");return false}console.log(need_imgcode);if(need_imgcode==1){console.log(captcha);if(!captcha){alert("请输入图形验证码");return false}getMsgCode(cellphone,captcha)}else{getMsgCode(cellphone,captcha)}});function getMsgCode(b,a){console.log(111);$.ajax({type:"get",url:httpHead+"/activity/Webuser/getCode?cellphone="+b+"&captcha="+a,dataType:"jsonp",xhrFields:{withCredentials:true},crossDomain:true,success:function(f){console.log(f);if(f.code==401){need_imgcode=1;$(".login-captchacode-wrapper").show()}else{if(f.code==200){var e=59;var d=setInterval(c,1000);function c(){getmsgcodeBtn.attr("disabled",true);getmsgcodeBtn.css("background","#999");getmsgcodeBtn.val(e+"s");if(e==0){getmsgcodeBtn.val("获取验证码").removeAttr("disabled");getmsgcodeBtn.css("background","#E92C2A");clearInterval(d)}e--}}else{if(f.code==429){if(need_imgcode==1){getcaptchaFn()}alert("请求次数过多,请稍后重试")}else{if(f.code==400){alert("图形验证码错误");if(f.isUpdate==1){getcaptchaFn()}}else{if(f.code==449){alert("请求太频繁");if(need_imgcode==1){getcaptchaFn()}}}}}}},error:function(c){alert(c.msg)}})}getcaptchaBtn.click(getcaptchaFn);function getcaptchaFn(){getcaptchaBtn.attr("src",httpHead+"/activity/Webuser/getCaptcha?t="+new Date().getTime())}function GetQueryString(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");var c=window.location.search.substr(1).match(b);if(c!=null){return unescape(c[2])}return null}function checkMobile(a){if(!(/^1(3[0-9]|4[57]|5[0-35-9]|7[0135678]|8[0-9]|6[8])\d{8}$/.test(cellphone))){return false}return true
}function showOver(b){$("#over").show();var a={"score":2000,"totalscore":9888,"defeat":68,"gamenum":gameNum,"name":"239874098","deadtime":"2018.2.26"};updateoverData(a)}function updateoverData(a){$("#totalscore").text(a.totalscore);$("#defeat").text(a.defeat);$("#gameNum").text(a.gamenum);if(a.gameNum<=0){$(".playagin").addClass("noagin")}if(a.score<3000){$(".winer").hide();$(".loser").show()}else{$(".loser").hide();$(".winer").children(".discount").remove();var b="";if(a.score<5000){b="discount95"}else{if(a.score<7000){b="discount90"}else{b="discount85"}}var c='<div class="discount '+b+' "><div >仅限<span id="over-owner">'+a.name+'</span>使用</div><div>有效期至<span id="over-deadtime">'+a.deadtime+"</span></div></div>";$(".winer").append($(c));$(".winer").show()}};
	</script>	
		
	<!--//游戏逻辑-->	
	<script>
	var width=window.innerWidth;var height=window.innerHeight;var spicJson={"frames":[{"filename":"coinbg","frame":{"x":2,"y":201,"w":112,"h":41},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":112,"h":41},"sourceSize":{"w":112,"h":41}},{"filename":"crash","frame":{"x":2,"y":244,"w":93,"h":76},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":93,"h":76},"sourceSize":{"w":93,"h":76}},{"filename":"garbagecan","frame":{"x":170,"y":174,"w":81,"h":61},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":12,"w":81,"h":61},"sourceSize":{"w":81,"h":81}},{"filename":"loadingbar","frame":{"x":2,"y":66,"w":176,"h":12},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":176,"h":12},"sourceSize":{"w":176,"h":12}},{"filename":"loadingbg","frame":{"x":2,"y":2,"w":188,"h":62},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":188,"h":62},"sourceSize":{"w":188,"h":62}},{"filename":"myprizebtn","frame":{"x":180,"y":79,"w":65,"h":48},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":65,"h":48},"sourceSize":{"w":65,"h":48}},{"filename":"one","frame":{"x":2,"y":322,"w":36,"h":74},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":0,"w":36,"h":74},"sourceSize":{"w":52,"h":74}},{"filename":"playcount","frame":{"x":170,"y":298,"w":49,"h":49},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":49,"h":49},"sourceSize":{"w":49,"h":49}},{"filename":"plus100","frame":{"x":97,"y":310,"w":45,"h":13},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":45,"h":13},"sourceSize":{"w":45,"h":13}},{"filename":"roadblock","frame":{"x":192,"y":2,"w":59,"h":75},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":12,"y":2,"w":59,"h":75},"sourceSize":{"w":81,"h":81}},{"filename":"rulesbtn","frame":{"x":177,"y":129,"w":58,"h":43},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":58,"h":43},"sourceSize":{"w":58,"h":43}},{"filename":"sharebtn","frame":{"x":2,"y":80,"w":173,"h":39},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":173,"h":39},"sourceSize":{"w":173,"h":39}},{"filename":"startbtn","frame":{"x":2,"y":121,"w":173,"h":35},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":173,"h":35},"sourceSize":{"w":173,"h":35}},{"filename":"stone","frame":{"x":170,"y":237,"w":81,"h":59},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":11,"w":81,"h":59},"sourceSize":{"w":81,"h":81}},{"filename":"three","frame":{"x":116,"y":234,"w":52,"h":74},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":52,"h":74},"sourceSize":{"w":52,"h":74}},{"filename":"timerbg","frame":{"x":2,"y":158,"w":112,"h":41},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":112,"h":41},"sourceSize":{"w":112,"h":41}},{"filename":"two","frame":{"x":116,"y":158,"w":52,"h":74},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":52,"h":74},"sourceSize":{"w":52,"h":74}}],"meta":{"app":"http://www.texturepacker.com","version":"1.0","image":"littlepic.png","format":"RGBA8888","size":{"w":256,"h":512},"scale":"1","smartupdate":"$TexturePacker:SmartUpdate:58acf86a3872a15ce4999f79014e07a7$"}};var game=new Phaser.Game(width,height,Phaser.CANVAS,"game",true);var states={boot:function(){this.preload=function(){game.load.image("loadingbg","//i1.yongche.name/media/g2/M02/1B/3C/rBEBP1psgt2IQiGTAAAoFpSO9-sAAK3pwDtc0IAACgu105.png");game.load.image("loadingbar","//i2.yongche.name/media/g2/M02/1A/29/rBEBP1psgt2IFDjJAAADk5OHafEAAKXpgP__FUAAAOr234.png")},this.create=function(){game.add.image(0,0,"loadingbg")},this.render=function(){game.state.start("preload")}},preload:function(){this.preload=function(){console.log("preload");var c=game.add.sprite(game.world.centerX,game.world.centerY,"loadingbg");var b=game.add.sprite(0,0,"loadingbar");b.reset(game.world.centerX-b.width/2,game.world.centerY);c.anchor.setTo(0.5,0.5);b.anchor.setTo(0,-1.05);game.load.setPreloadSprite(b);game.load.image("homepagebg","//i1.yongche.name/media/g2/M02/1B/3C/rBEBJVpsgt6IHjdVAAUk18WQAk8AAK3pwDoAbIABSTv734.png");game.load.image("playbg","//i2.yongche.name/media/g2/M02/1B/3C/rBEBJVpshD-IRIH5AAwuu5PgIhoAAK3pwF50ssADC7T160.png");game.load.spritesheet("dude","//i3.yongche.name/media/g2/M02/1B/3C/rBEBP1psgt2IB7m-AAB72lgDCkcAAK3pwDnhcAAAHvy584.png",47,55);game.load.spritesheet("coin","//i2.yongche.name/media/g2/M02/1B/3C/rBEBP1psgt2IIJy2AAA9w4g5HbIAAK3pwDnR-UAAD3b307.png",81,81);game.load.spritesheet("mute-play","//i3.yongche.name/media/g2/M02/1B/3C/rBEBJVpsgt6IVvREAAANsPV9iJMAAK3pwDt1CMAAA3I754.png",32,23);game.load.audio("bgMusic","//24haowan-cdn.shanyougame.com/pickApple2/assets/audio/bgMusic.mp3");game.load.audio("scoreMusic","http://i1.yongche.name/s/download/201801/addscore.mp3?1478153218");game.load.audio("bombMusic","audio/boom.mp3");game.sound.usingWebAudio=false;game.sound.usingAudioTag=true;game.load.atlas("spic","//i1.yongche.name/media/g2/M02/1B/3C/rBEBJVpshD-IM3RqAAEK2zr4or4AAK3pwGGQR4AAQrz533.png",null,spicJson);
game.load.onLoadComplete.add(a);function a(){initData()}}},created:function(){var b,a;this.create=function(){this.soundManager=game.sound;var e=game.add.image(0,0,"homepagebg");e.width=game.world.width;e.height=game.world.height;ruleButton=game.add.button(game.world.width-60-9,20,"spic",f,this,"rulesbtn","rulesbtn","rulesbtn");function f(){$("#rule").fadeIn(100)}prizeButton=game.add.button(16,16,"spic",g,this,"myprizebtn","myprizebtn","myprizebtn");function g(){if(!isLogin){$("#loginMask").show();return}$("#prize").fadeIn(100)}var i=game.add.text(game.world.centerX,game.world.height-140,"我有"+gameNum+"次游戏机会",{fontSize:"18px",fill:"#FFFFFF"});i.anchor.setTo(0.5,1);startButton=game.add.button(game.world.centerX,game.world.height-90,"spic",c,this,"startbtn","startbtn","startbtn");startButton.anchor.setTo(0.5,1);function c(){if(!isLogin){$("#loginMask").show();return}if(gameNum<=0){alert("分享可获得游戏机会");return}gameNum-=1;startGame()}shareButton=game.add.button(game.world.centerX,game.world.height-35,"spic",h,this,"sharebtn","sharebtn","sharebtn");shareButton.anchor.setTo(0.5,1);function h(){if(!isLogin){$("#loginMask").show();return}shareFn()}a=game.add.button(game.world.width-32-14,game.world.height-23-14,"mute-play",d,this,0,0,0);this.judgeMute();a.anchor.setTo(0.5,0.5);function d(){this.soundManager.mute=!this.soundManager.mute;this.judgeMute()}},this.judgeMute=function(c){if(c){if(this.soundManager.mute){a.angle=0}else{a.angle+=1}}else{if(this.soundManager.mute){a.setFrames(1,1,1)}else{a.setFrames(0,0,0)}}}},play:function(){var a=30,h,b,d,i,c=0,e=200,g=width/8,f=["stone","roadblock","garbagecan"];this.create=function(){console.log("play-create");this.touching=false;this.isAllStop=false;this.soundManager=game.sound;if(!d){d=game.add.audio("bgMusic");d.loopFull()}h=game.add.audio("scoreMusic");b=game.add.audio("bombMusic");this.bg=game.add.tileSprite(0,0,game.world.width,game.world.height,"playbg");game.physics.enable(this.bg,Phaser.Physics.ARCADE);this.bgImg=game.cache.getImage("playbg");this.bg.tileScale.x=game.world.width/this.bgImg.width;this.bg.tileScale.y=game.world.height/this.bgImg.height;this.car=this.game.add.sprite(game.world.centerX,game.world.height-100,"dude");this.car.width=120;this.car.height=140;this.car.anchor.setTo(0.5,0.5);game.physics.arcade.enable(this.car);this.car.body.setSize(30,60,0,0);this.car.animations.add("left",[8],10,true);this.car.animations.add("center",[0,2,4,6],10,true);this.car.animations.add("right",[12],10,true);this.car.animations.add("over",[16],10,true);this.car.animations.play("center");this.obstacles=game.add.group();this.obstacles.enableBody=true;var k=game.add.image(19,16,"spic","timerbg");this.remainTime=60;var n={font:"20px Arial",fill:"#ffffff"};this.remainTimeText=this.game.add.text(62,25,"01：00",n);var k=game.add.image(game.world.centerX,42,"spic","playcount");k.anchor.setTo(0.5,0.5);var n={font:"22px Arial",fill:"#ffffff"};this.remainCountText=this.game.add.text(game.world.centerX,42,gameNum,n);this.remainCountText.anchor.setTo(0.5,0.5);var m=game.add.image(game.world.width-19-112,16,"spic","coinbg");this.score=0;var n={font:"20px Arial",fill:"#ffffff"};this.scoreText=this.game.add.text(game.world.width-19-90,25," "+this.score,n);i=game.add.button(game.world.width-32-14,game.world.height-23-14,"mute-play",l,this,0,0,0);this.judgeMute();i.anchor.setTo(0.5,0.5);function l(){this.soundManager.mute=!this.soundManager.mute;this.judgeMute()}this.game.input.addMoveCallback(this.moveCallback,this);game.input.onDown.add(this.onDownCb,this);this.game.input.onUp.add(this.onUpCb,this);var o=this;var j=window.localStorage.getItem("firstplay");if(!j){$("#leadPage").fadeIn(100);j=window.localStorage.setItem("firstplay",true)}else{this.ThreeTwoOne()}$("#close_leadPage").click(function(){$("#leadPage").fadeOut(100);o.ThreeTwoOne()})},this.update=function(){this.judgeMute(1);game.physics.arcade.overlap(this.car,this.obstacles,this.crashCarFunc,null,this)},this.moveCallback=function(l,j,m,k){if(k||!touching){return}console.log(123);if(c<j){this.car.animations.play("right")}else{if(c==j){this.car.animations.play("center")}else{if(c>j){this.car.animations.play("left")}}}c=j;if(j<=a+this.car.width/2){this.car.x=a+this.car.width/2}else{if(j>=(game.world.width-a-this.car.width/2)){this.car.x=game.world.width-a-this.car.width/2}else{this.car.x=j}}},this.onDownCb=function(j){touching=true},this.onUpCb=function(j){touching=false;if(this.isAllStop){return}this.car.animations.play("center")},this.ThreeTwoOne=function(j){var k=3;var l=["one","two","three"];var m=game.time.events.loop(1000,function(){if(k<=0){game.time.events.remove(m);this.reduceTimer=game.time.events.loop(500,this.timerCallback,this);return}this.tweenImg(l[k-1]);k--},this)},this.tweenImg=function(j){var l=game.add.image(game.world.centerX,game.world.centerY,"spic",j);l.width=0;l.height=0;l.anchor.setTo(0.5,0.5);l.alpha=0;var k=game.add.tween(l).to({alpha:1,width:game.world.width/3,height:game.world.width/3},200,Phaser.Easing.Linear.None,true,0,0,false);
k.onComplete.add(function(){var m=game.add.tween(l).to({alpha:0,width:0,height:0},200,Phaser.Easing.Linear.None,true,200,0,false);m.onComplete.add(function(){})})},this.judgeMute=function(j){if(j){if(this.soundManager.mute){i.angle=0}else{i.angle+=1}}else{if(this.soundManager.mute){i.setFrames(1,1,1)}else{i.setFrames(0,0,0)}}},this.add_move_sprite=function(){var j=Math.floor(Math.random()*10);if(j<=3){this.addmystones("coin",1)}else{if(j<=5){this.addmystones("coin",2)}else{if(j<=6){this.addmystones("stone",1)}else{if(j<=8){this.addmystones("roadblock",1)}else{this.addmystones("garbagecan",1)}}}}},this.addmystones=function(p,r){var l=Math.floor(Math.random()*3);var k=(game.world.width-a*2)/6;for(var o=0;o<r;o++){var m;var q;if(p==="coin"){m=this.obstacles.create(0,0,p);m.animations.add("jump",[0,1,2,3],8,true);m.animations.play("jump");q=(70)*(r-o-1)}else{m=this.obstacles.create(0,0,"spic",p);q=0}var j=a+k*(l*2+1)-m.width/2;m.reset(j,q);m.type=p;m.width=70;m.height=70;m.body.setSize(40,40,0,0);m.checkWorldBounds=true;m.outOfBoundsKill=true}},this.timerCallback=function(){this.add_move_sprite();this.reduceTime()},this.reduceTime=function(){this.remainTime-=0.5;var l=parseInt(this.remainTime)<10?"0"+parseInt(this.remainTime):parseInt(this.remainTime);this.remainTimeText.text="00: "+l;var j=e+(60-this.remainTime)*20;this.bg.autoScroll(0,j/(game.world.height/this.bgImg.height));this.obstacles.forEachAlive(function(m){m.body.velocity.y=j});if(this.remainTime<=0){this.allStopMove();this.bg.autoScroll(0,0);alert("时间到");var k=this;game.time.events.add(1000,function(){showOver(this.score)},this)}},this.allStopMove=function(){this.game.time.events.remove(this.reduceTimer);this.obstacles.forEach(function(j){j.body.velocity.y=0});this.isAllStop=true;this.game.input.deleteMoveCallback(this.moveCallback,this)},this.crashCarFunc=function(k,m){m.kill();var o="";if(m.type==="coin"){o="plus100";this.score+=1;this.scoreText.text=this.score;h.play()}else{this.bg.autoScroll(0,0);this.car.animations.play("over");o="crash";this.allStopMove();b.play()}var l=game.add.image(m.x,m.y,"spic",o);l.alpha=0;var j=game.add.tween(l).to({alpha:1,y:l.y-20},100,Phaser.Easing.Linear.None,true,0,0,false);var n=this;j.onComplete.add(function(){var p=game.add.tween(l).to({alpha:0,y:l.y-20},100,Phaser.Easing.Linear.None,true,200,0,false);p.onComplete.add(function(){l.kill();if(m.type==="coin"){return}game.time.events.add(1000,function(){showOver(this.score)},this)})})}}};Object.keys(states).map(function(a){game.state.add(a,states[a])});game.state.start("boot");
	
	
	</script>
	
	<!--//微信二次分享-->
	<script>
	var Tools;function ajaxShare(f){var k="yongche://share?";var c="yongche://shareToFriend?";var e="yongche://shareToTimeline?";var h=encodeURIComponent(f.url);var a=encodeURIComponent("http://i3.yongche.Name/media/g2/M01/1A/35/rBEBJVo82ViIBg3PAAAydsM-krwAAKcAAK_ajsAADKO105.jpg");var i=encodeURIComponent(f.title);var g=encodeURIComponent(f.description);var j=encodeURIComponent("://m.yongche.com");var m=42;var d="share_callback";Tools={shareThisPage:function(){var o="link="+h+"&pics="+a+"&title="+i+"&content="+g+"&sourceType="+m+"&callback="+d+"&codeUrl="+j;var n=k+o;window.location.href=n},shareThisPageToFriend:function(){var o="link="+h+"&pics="+a+"&title="+i+"&content="+g+"&sourceType="+m+"&callback="+d+"&codeUrl="+j;var n=c+o;window.location.href=n},shareThisPageToTimeline:function(){var o="link="+h+"&pics="+a+"&title="+i+"&content="+g+"&sourceType="+m+"&callback="+d+"&codeUrl="+j;var n=e+o;window.location.href=_tmppenLOink}};var l="link="+h+"&pics="+a+"&title="+i+"&content="+g+"&sourceType="+m+"&from=iframe&callback="+d;var b=k+l;console.log(b)}(function(a){a.fn.wxShare=function(c){var e=c.shareImg;var b=c.shareTitle;var d=c.shareContent;var f=c.shareUrl;a.ajax({url:"//weixin.yongche.com/wechat/jssdk/config?url="+encodeURIComponent(window.location.href),method:"get",dataType:"jsonp"}).done(function(h){console.log(h);if(h.code==200){g(h.result)}}).fail(function(h){});function g(h){wx.config({debug:false,appId:h.appId,timestamp:h.timestamp,nonceStr:h.nonceStr,signature:h.signature,jsApiList:["onMenuShareAppMessage","onMenuShareTimeline","onMenuShareQQ","onMenuShareWeibo"]});wx.ready(function(){var i={link:f,imgUrl:e,title:b,desc:d,type:"",dataUrl:"",success:function(){},cancel:function(){}};wx.onMenuShareAppMessage(i);wx.onMenuShareTimeline(i);wx.onMenuShareQQ(i)})}};window.wxShareFn=function(b){a.fn.wxShare(b)}})(jQuery);(function(d,e,j,h,f,c,b){d["GoogleAnalyticsObject"]=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-18761483-4","auto");ga("send","pageview");
	
	</script>
	</body>
</html>
